// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id    String @id @default(uuid())
  email String @unique
  name  String?
  password String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  submission Submissions[]
}

model Admin {
  id    String @id @default(uuid())
  email String @unique
  name  String?
  password String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdProblems Problems[]
}

//! problem schema should also have cpu limit and memory limit according to the question and also 

model Problems {
  id  Int @id @default(autoincrement())
  adminId String 
  title String
  description String
  inputStatement String
  outputStatement String
  visibleTestCase VisibleTestCase[]
  hiddenTestCase HiddenTestCase[]
  admin  Admin @relation(fields: [adminId], references: [id])

}

model VisibleTestCase{
  id   String @id @default(uuid())
  problemId  Int  
  input String 
  output String
  order  Int
  problem Problems @relation(fields: [problemId], references: [id], onDelete: Cascade)
  @@index([problemId])
}


model HiddenTestCase {
  id String @id @default(uuid())
  problemId Int 
  input String
  output String
  order Int
  problem Problems @relation(fields: [problemId], references: [id] , onDelete: Cascade)
  @@index([problemId])
}


model Submissions {
  id String @id @default(uuid())
  userId String 
  problemId Int 
  language String
  code String
  state  SubmissionState @default(PENDING)
  verdict  SubmissionVerdict @default(PENDING)
  AttemptedAt DateTime @default(now())
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}



enum SubmissionState {
  PENDING
  FAILED
  PROCESSING  
  SUCCESS
}


enum SubmissionVerdict {
  AC   // Accepted
  WA   // Wrong Answer
  CE   // Compilation Error
  RE   // Runtime Error
  TLE  // Time Limit Exceeded
  MLE  // Memory Limit Exceeded
  OLE  // Output Limit Exceeded
  PE   // Presentation Error
  ILE  // Idleness Limit Exceeded
  SV   // Security Violation / Restricted Function
  JE   // Judge Error
  SKIPPED // Not evaluated / skipped
  PENDING //FOR DEFAULT VALUE
}
